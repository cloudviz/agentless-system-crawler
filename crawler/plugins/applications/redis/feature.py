from collections import namedtuple


def create_feature(metrics):
    fields = RedisFeature._fields

    for field_name in fields:
        if field_name not in metrics:
            metrics[field_name] = ""

    feature_attributes = RedisFeature(
        metrics['aof_current_rewrite_time_sec'],
        metrics['aof_enabled'],
        metrics['aof_last_bgrewrite_status'],
        metrics['aof_last_rewrite_time_sec'],
        metrics['aof_last_write_status'],
        metrics['aof_rewrite_in_progress'],
        metrics['aof_rewrite_scheduled'],
        metrics['arch_bits'],
        metrics['blocked_clients'],
        metrics['client_biggest_input_buf'],
        metrics['client_longest_output_list'],
        metrics['cluster_enabled'],
        metrics['config_file'],
        metrics['connected_clients'],
        metrics['connected_slaves'],
        metrics['evicted_keys'],
        metrics['executable'],
        metrics['expired_keys'],
        metrics['gcc_version'],
        metrics['hz'],
        metrics['instantaneous_input_kbps'],
        metrics['instantaneous_ops_per_sec'],
        metrics['instantaneous_output_kbps'],
        metrics['keyspace_hits'],
        metrics['keyspace_misses'],
        metrics['latest_fork_usec'],
        metrics['loading'],
        metrics['lru_clock'],
        metrics['master_repl_offset'],
        metrics['maxmemory'],
        metrics['maxmemory_human'],
        metrics['maxmemory_policy'],
        metrics['mem_allocator'],
        metrics['mem_fragmentation_ratio'],
        metrics['migrate_cached_sockets'],
        metrics['multiplexing_api'],
        metrics['os'],
        metrics['process_id'],
        metrics['pubsub_channels'],
        metrics['pubsub_patterns'],
        metrics['rdb_bgsave_in_progress'],
        metrics['rdb_changes_since_last_save'],
        metrics['rdb_current_bgsave_time_sec'],
        metrics['rdb_last_bgsave_status'],
        metrics['rdb_last_bgsave_time_sec'],
        metrics['rdb_last_save_time'],
        metrics['redis_build_id'],
        metrics['redis_git_dirty'],
        metrics['redis_git_sha1'],
        metrics['redis_mode'],
        metrics['redis_version'],
        metrics['rejected_connections'],
        metrics['repl_backlog_active'],
        metrics['repl_backlog_first_byte_offset'],
        metrics['repl_backlog_histlen'],
        metrics['repl_backlog_size'],
        metrics['role'],
        metrics['run_id'],
        metrics['sync_full'],
        metrics['sync_partial_err'],
        metrics['sync_partial_ok'],
        metrics['tcp_port'],
        metrics['total_commands_processed'],
        metrics['total_connections_received'],
        metrics['total_net_input_bytes'],
        metrics['total_net_output_bytes'],
        metrics['total_system_memory'],
        metrics['total_system_memory_human'],
        metrics['uptime_in_days'],
        metrics['uptime_in_seconds'],
        metrics['used_cpu_sys'],
        metrics['used_cpu_sys_children'],
        metrics['used_cpu_user'],
        metrics['used_cpu_user_children'],
        metrics['used_memory'],
        metrics['used_memory_peak'],
        metrics['used_memory_peak_human'],
        metrics['used_memory_rss'],
        metrics['used_memory_rss_human']
    )
    return feature_attributes

RedisFeature = namedtuple('RedisFeature', [
    'aof_current_rewrite_time_sec',
    'aof_enabled',
    'aof_last_bgrewrite_status',
    'aof_last_rewrite_time_sec',
    'aof_last_write_status',
    'aof_rewrite_in_progress',
    'aof_rewrite_scheduled',
    'arch_bits',
    'blocked_clients',
    'client_biggest_input_buf',
    'client_longest_output_list',
    'cluster_enabled',
    'config_file',
    'connected_clients',
    'connected_slaves',
    'evicted_keys',
    'executable',
    'expired_keys',
    'gcc_version',
    'hz',
    'instantaneous_input_kbps',
    'instantaneous_ops_per_sec',
    'instantaneous_output_kbps',
    'keyspace_hits',
    'keyspace_misses',
    'latest_fork_usec',
    'loading',
    'lru_clock',
    'master_repl_offset',
    'maxmemory',
    'maxmemory_human',
    'maxmemory_policy',
    'mem_allocator',
    'mem_fragmentation_ratio',
    'migrate_cached_sockets',
    'multiplexing_api',
    'os',
    'process_id',
    'pubsub_channels',
    'pubsub_patterns',
    'rdb_bgsave_in_progress',
    'rdb_changes_since_last_save',
    'rdb_current_bgsave_time_sec',
    'rdb_last_bgsave_status',
    'rdb_last_bgsave_time_sec',
    'rdb_last_save_time',
    'redis_build_id',
    'redis_git_dirty',
    'redis_git_sha1',
    'redis_mode',
    'redis_version',
    'rejected_connections',
    'repl_backlog_active',
    'repl_backlog_first_byte_offset',
    'repl_backlog_histlen',
    'repl_backlog_size',
    'role',
    'run_id',
    'sync_full',
    'sync_partial_err',
    'sync_partial_ok',
    'tcp_port',
    'total_commands_processed',
    'total_connections_received',
    'total_net_input_bytes',
    'total_net_output_bytes',
    'total_system_memory',
    'total_system_memory_human',
    'uptime_in_days',
    'uptime_in_seconds',
    'used_cpu_sys',
    'used_cpu_sys_children',
    'used_cpu_user',
    'used_cpu_user_children',
    'used_memory',
    'used_memory_peak',
    'used_memory_peak_human',
    'used_memory_rss',
    'used_memory_rss_human',
])
